<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - SkillBet Arena</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/cyber-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="cosmic-theme">
    <!-- Cosmic Background Elements -->
    <div class="cosmic-background">
        <div class="nebula"></div>
        <div class="floating-planet planet-1"></div>
        <div class="floating-planet planet-2"></div>
        <div class="floating-planet planet-3"></div>
        <div class="star-field">
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
            <div class="star"></div>
        </div>
    </div>

    <!-- Top Navigation Bar -->
    <nav class="cosmic-navbar">
        <div class="cosmic-nav-container">
            <div class="cosmic-nav-logo">
                <h2>SkillBet <span>Arena</span></h2>
            </div>
            <div class="cosmic-nav-icons">
                <div class="nav-icon">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </div>
                <div class="nav-icon" onclick="window.location.href='settings.html'">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="user-profile-cosmic">
                    <img src="../assets/images/default-avatar.png" alt="User" class="profile-pic-cosmic" id="topNavAvatar">
                    <div class="user-info">
                        <span class="username-cosmic" id="topNavUsername">Loading...</span>
                        <span class="points" id="topNavPoints">0 pts</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Welcome Banner -->
    <section class="welcome-banner">
        <div class="container">
            <div class="banner-content">
                <h2 class="welcome-title">Welcome Back, <span class="username-highlight" id="welcomeUsername">Loading...</span></h2>
                <p class="welcome-subtitle">Ready to conquer new challenges today?</p>
            </div>
        </div>
    </section>

    <!-- Hero Section -->
    <section class="cosmic-hero">
        <div class="cosmic-glow"></div>
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="cosmic-title">SkillBet <span>Arena</span></h1>
                    <p class="cosmic-subtitle">Compete. Win. Level Up.</p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <i class="fas fa-coins"></i>
                            <span id="heroWalletBalance">â‚¹0</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-trophy"></i>
                            <span id="heroGamesWon">0 Wins</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-chart-line"></i>
                            <span id="heroWinRate">0% Win Rate</span>
                        </div>
                    </div>
                    <button class="cosmic-btn primary" onclick="window.location.href='games.html'">Play Now</button>
                </div>
                <div class="hero-illustration">
                    <div class="cosmic-illustration-card">
                        <i class="fas fa-gamepad cosmic-icon"></i>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Games Section -->
    <section class="cosmic-games">
        <div class="container">
            <div class="games-grid-cosmic">
                <!-- Typing Battle -->
                <div class="cosmic-game-card">
                    <div class="game-icon-cosmic">
                        <i class="fas fa-keyboard"></i>
                    </div>
                    <h3>Typing Battle</h3>
                    <p>Race against time in high-speed typing competitions</p>
                    <button class="cosmic-btn secondary" onclick="window.location.href='games.html'">PLAY NOW</button>
                </div>

                <!-- Math Challenge -->
                <div class="cosmic-game-card">
                    <div class="game-icon-cosmic">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>Math Challenge</h3>
                    <p>Solve complex equations under pressure</p>
                    <button class="cosmic-btn secondary" onclick="window.location.href='games.html'">PLAY NOW</button>
                </div>

                <!-- Coding Duel -->
                <div class="cosmic-game-card">
                    <div class="game-icon-cosmic">
                        <i class="fas fa-code"></i>
                    </div>
                    <h3>Coding Duel</h3>
                    <p>Battle with algorithms and data structures</p>
                    <button class="cosmic-btn secondary" onclick="window.location.href='games.html'">PLAY NOW</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Leaderboard Section -->
    <section class="cyber-leaderboard">
        <div class="container">
            <div class="leaderboard-cards">
                <div class="leaderboard-card">
                    <div class="rank-badge">1</div>
                    <div class="player-avatar-cyber">
                        <img src="../assets/images/default-avatar.png" alt="Player" id="leaderboardFirstAvatar">
                        <div class="trophy-gold"><i class="fas fa-trophy"></i></div>
                    </div>
                    <div class="player-info-cyber">
                        <h4 id="leaderboardFirstName">Loading...</h4>
                        <p id="leaderboardFirstPoints">0 pts</p>
                    </div>
                </div>
                
                <div class="leaderboard-card">
                    <div class="rank-badge">2</div>
                    <div class="player-avatar-cyber">
                        <img src="../assets/images/default-avatar.png" alt="Player" id="leaderboardSecondAvatar">
                        <div class="trophy-silver"><i class="fas fa-trophy"></i></div>
                    </div>
                    <div class="player-info-cyber">
                        <h4 id="leaderboardSecondName">Loading...</h4>
                        <p id="leaderboardSecondPoints">0 pts</p>
                    </div>
                </div>
                
                <div class="leaderboard-card">
                    <div class="rank-badge">3</div>
                    <div class="player-avatar-cyber">
                        <img src="../assets/images/default-avatar.png" alt="Player" id="leaderboardThirdAvatar">
                        <div class="trophy-bronze"><i class="fas fa-trophy"></i></div>
                    </div>
                    <div class="player-info-cyber">
                        <h4 id="leaderboardThirdName">Loading...</h4>
                        <p id="leaderboardThirdPoints">0 pts</p>
                    </div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="cosmic-btn secondary" onclick="window.location.href='leaderboard.html'">VIEW FULL LEADERBOARD</button>
            </div>
        </div>
    </section>
    
    <!-- Daily Rewards Widget -->
    <section class="cosmic-rewards">
        <div class="container">
            <div class="reward-widget">
                <div class="reward-content">
                    <h3>Daily Reward</h3>
                    <div class="coin-animation">
                        <i class="fas fa-coins"></i>
                    </div>
                    <p>Claim your daily coins!</p>
                    <button class="cosmic-btn reward">CLAIM REWARD</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Bottom Navigation -->
    <nav class="cosmic-bottom-nav">
        <div class="nav-item-cosmic active" onclick="window.location.href='home.html'">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-item-cosmic" onclick="window.location.href='games.html'">
            <i class="fas fa-gamepad"></i>
            <span>Games</span>
        </div>
        <div class="nav-item-cosmic" onclick="window.location.href='wallet.html'">
            <i class="fas fa-wallet"></i>
            <span>Wallet</span>
        </div>
        <div class="nav-item-cosmic" onclick="window.location.href='leaderboard.html'">
            <i class="fas fa-trophy"></i>
            <span>Leaderboard</span>
        </div>
        <div class="nav-item-cosmic" onclick="window.location.href='profile.html'">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </div>
    </nav>

    <script type="module" src="../assets/js/home.js"></script>
    <script type="module">
        import { supabase } from '../assets/js/supabase.js';
        import { logoutUser } from '../assets/js/auth.js';

        // Check if user is logged in
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (!session) {
                    // User is not logged in, redirect to welcome page
                    window.location.href = '../welcome.html';
                }
            } catch (error) {
                console.error('Error checking session:', error);
                // In case of error, redirect to welcome page
                window.location.href = '../welcome.html';
            }
        });

        // Logout function
        async function logout() {
            try {
                await logoutUser();
                // Redirect to welcome page after logout
                window.location.href = '../welcome.html';
            } catch (error) {
                console.error('Logout error:', error);
                alert('Logout failed: ' + error.message);
            }
        }

        // Make logout function available globally
        window.logout = logout;
    </script>
</body>
</html>